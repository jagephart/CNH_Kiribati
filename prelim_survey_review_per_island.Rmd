---
title: "Exploratory figures for CNHS"
author: "Kelvin Gorospe and Jessica Gephart"
date: "6/10/2020"
output: pdf_document
---


Notes for Mike:

* Is it correct to remove the 0/1 columns in the market Survey data?
* Is there a way to automate this process on your end? So that code still works with new data
* Where is the market availability data that we had in the last iteration?
* [name of product]_roster is the availability data
* What is the meaning of NA in the multiselect variable columns?
* "." and ".a" in STATA both mean missing. Refer to Mike's May 27 email for example (and to check for consistency with R)
* Why does VRS have household info and anemia info?
* Why are these output as different files (vrs, market, etc. each broken into multiple separate files)
* It is easiest to have the fewest number possible
* Are they going to translate the HIES iKiribati responses?
* Variable labels are cut off (how do we get the full answers back?) see: var_labels
* How to standardize units when none is given (e.g., question == Travel time outside boundary in outsideRoster dataset includes "12", "3", "30 minutes", "1 hour", etc)
* Is a response of "zero" the same as blank response? 
* What's the difference between interview__key and interview__id? Currently using both to join eventRoster, fishRoster, etc with vrs data to get island information

Suggested path forward:
 
1. Write out tidy versions of each data set and share csv
2. Write functions to visualize each question type:
     - Multi- and single-select, produce bar chart
     - Integer, produce bar chart
     - Continuous, produce histogram and (TBD: box and whisker)
     - Free response, compile unique answers with unique IDs for translation, question, island, possibly role
3. Loop through data and produce pdf of all plots
4. TBD: Start to creat summaries by village/island
 


```{r setup, echo = FALSE, warning = FALSE, message = FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(haven)
library(tidyverse)
library(magrittr)
library(ggplot2)

#___________________________________________________________________________________________#
# Read in tidy data files
# ___________________________________________________________________________________________#
# Note: datadir and outdir are the same now that data cleaning is done separately in clean_vrs and clean_market.R 
datadir <- "/Volumes/jgephart/Kiribati/Outputs"
outdir <- "/Volumes/jgephart/Kiribati/Outputs"

source("R_scripts/plotting_functions.R")

vrsTidy <- read.csv(file.path(datadir, "vrsTidy.csv"))
eventRosterTidy <- read.csv(file.path(datadir, "eventRosterTidy.csv"))
fishassetRosterTidy <- read.csv(file.path(datadir, "fishassetRosterTidy.csv"))
outsideRosterTidy <- read.csv(file.path(datadir, "outsideRosterTidy.csv"))
vrsRosterTidy <- read.csv(file.path(datadir, "vrsRosterTidy.csv"))
withinRosterTidy <- read.csv(file.path(datadir, "withinRosterTidy.csv"))

```

## Fisheries data
### *Note: no island information in current dataset


```{r, warning = FALSE}

# FIX IT - if island information becomes available for fisheries data, will also need to incorporate p903r and p922.dta files (in Fisheries data folder): just copy code from prelim_survey_review.Rmd

#___________________________________________________________________________________________#
# Clean fisheries data
#___________________________________________________________________________________________#
fisheries <- read_dta(file.path(datadir, "Fisheries", "Fisheries.dta"))

fisheries <- clean_data(fisheries)[[1]]

# Extract variable label attributes
var_labels <- clean_data(fisheries)[[2]]

# Change class to character to allow left_join without warning below
var_labels <- var_labels %>%
  mutate(col.names = as.character(col.names))

# Make tidy
fisheriesTidy <- tidy_data(df = fisheries, pivot_col_1 = "sex", pivot_col_last = "p922n3", var_labels = var_labels, question_no = TRUE) # question_no = TRUE applies to fisheries data where col.labels includes a third column for question.no

write.csv(fisheriesTidy, file.path(outdir, "fisheriesTidy.csv"), row.names = FALSE)

# Output QUESTION list:
write.csv(unique(fisheriesTidy$question), file.path(outdir, "fisheries_question_list.csv"), row.names = FALSE)

```



```{r, fig.height = 8, fig.width = 8, results = 'asis'}
#___________________________________________________________________________________________#
# Visualize fisheries data
#___________________________________________________________________________________________#
# Bar graphs and Histograms of single/multi-select questions


# Plot bar graph for each multi-select question
plotDF_multiselect <- fisheriesTidy %>%
  filter(!is.na(option)) %>%
  filter(response == "1")

plot_multi_response(plotDF_multiselect)

```


## Fisheries continued...
### *Single response questions*



```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

# List short-answer, fill-in response questions here:
fill_in_questions <- c("p903n", "p921n", "p922n1", "p922n2")

# Plot histogram for each single response question while removing zeroes
plotDF_single <- fisheriesTidy %>%
  filter(is.na(option)) %>%
  filter(question.no %in% fill_in_questions == FALSE) # remove "other" responses

plot_single_response(plotDF_single, bin_n = 20)
  

# Output short answer responses for translation
other_answers <- fisheriesTidy %>% 
  filter(question.no %in% fill_in_questions) %>%
  filter(response != "") %>% 
  unique() %>%
  arrange(question)

write.csv(other_answers, file.path(outdir, "fisheries_other_answers.csv"), row.names = FALSE)




```

## VRS Data
### *Multi-response questions*



```{r, warning=FALSE, fig.height = 8, fig.width = 8,  results = 'asis'}
#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Bar graphs and Histograms of single/multi-select questions

# Plot bar graph for each multi-select question
plotDF_multiselect <- vrsTidy %>%
  filter(!is.na(option)) %>%
  filter(response == "1")

plot_multi_response(plotDF_multiselect, incl_island = TRUE)

```

## VRS continued...
### *Single response questions*


```{r, fig.height = 8, fig.width = 8,  results = 'asis'}
# Plot histogram for each single response question while removing zeroes

# List short-answer, fill-in response questions here:
fill_in_questions <- vrsTidy %>%
  filter(str_detect(question, pattern = "Other") & question != "Other meeting restrictions") %>% 
  pull(question) %>% 
  unique()

# Additional fill-in response questions:
fill_in_questions <- c(fill_in_questions, "Gender attending meeting", "New village rules")

# FIX IT - confirm: assuming zero is different from "blank" (plotting function reports number of zeroes removed)
plotDF_single <- vrsTidy %>%
  filter(is.na(option)) %>%
  filter(question %in% fill_in_questions == FALSE)  %>% # remove all short answer questions 
  filter(response != "") %>% # If first response in a question set is blank, function plot_single_response does not work
  filter(question %in% c("VRS Village", "Household ID", "Start Time and Date for VRS section", "End Time and Date for VRS section",
                         "Errors count in the interview", "Status of the interview")==FALSE) # FIX IT - confirm: remove these too?

plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)


```


## Event Roster Data: List of events



```{r, warning=FALSE}

event_subsets <- eventRosterTidy %>%
  select(event_roster__id) %>%
  unique()

event_subsets


```

## *Event: Coral bleaching*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- eventRosterTidy %>%
  filter(event_roster__id == "Coral bleaching event")

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20,incl_island = TRUE)

```


## *Event: Cyclone*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- eventRosterTidy %>%
  filter(event_roster__id == "Cyclone")

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)

```


## *Event: Harmful algal bloom*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- eventRosterTidy %>%
  filter(event_roster__id == "Harmful algal bloom")

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)

```

## *Event: Tsunami*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- eventRosterTidy %>%
  filter(event_roster__id == "Tsunami")

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)

```

## Fish Roster Data: List of fish assets

```{r, warning=FALSE}
event_subsets <- fishassetRosterTidy %>%
  select(fish_asset_roster__id) %>%
  unique()

event_subsets
```

### *Asset: Fibreglass boats*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- fishassetRosterTidy %>%
  filter(fish_asset_roster__id == "Fibreglass boats")

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)

```
## *Asset: Outboard Motors*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- fishassetRosterTidy %>%
  filter(fish_asset_roster__id == "Outboard Motors")

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)

```




## *Asset: Fishing Nets (gillnet)*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- fishassetRosterTidy %>%
  filter(fish_asset_roster__id == "Fishing Nets (gillnet)")

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)

```

## *Asset: Spearguns*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- fishassetRosterTidy %>%
  filter(fish_asset_roster__id == "Spearguns")

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)

```




## *Asset: Fishing Lines*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- fishassetRosterTidy %>%
  filter(fish_asset_roster__id == "Fishing Lines")

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)
```




## *Asset: Active Fish Traps*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets
plotDF_single <- fishassetRosterTidy %>%
  filter(fish_asset_roster__id == "Active Fish Traps")

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)
```





## *Asset: Underwater flashlights*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- fishassetRosterTidy %>%
  filter(fish_asset_roster__id == "Underwater flashlights")

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)
```


## *Asset: Wood canoes*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- fishassetRosterTidy %>%
  filter(fish_asset_roster__id == "Wood canoes")

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)

```


## *Asset: Eskies/portable coolers*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- fishassetRosterTidy %>%
  filter(fish_asset_roster__id == "Eskies/portable coolers")

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)

```




## *Asset: SCUBA diving equipment*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- fishassetRosterTidy %>%
  filter(fish_asset_roster__id == "SCUBA diving equipment")

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)

```



## *Asset: Freezers (electric or propane)*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- fishassetRosterTidy %>%
  filter(fish_asset_roster__id == "Freezers (electric or propane)")

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)

```




## *Asset: Ice machines*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- fishassetRosterTidy %>%
  filter(fish_asset_roster__id == "Ice machines")

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)

```




## *Asset: Fishing Nets (purse)*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- fishassetRosterTidy %>%
  filter(fish_asset_roster__id == "Fishing Nets (purse)")

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)

```

## *Asset: Drag Nets*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- fishassetRosterTidy %>%
  filter(fish_asset_roster__id == "Drag Nets")

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)

```



## *Asset: Harpoons/Spears*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- fishassetRosterTidy %>%
  filter(fish_asset_roster__id == "Harpoons/Spears")

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)

```


## *Asset: FAD (Fish Aggregating Device)*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- fishassetRosterTidy %>%
  filter(fish_asset_roster__id == "FAD (Fish Aggregating Device)")

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)

```


## *Asset: Other Fishing Equipment (note)*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- fishassetRosterTidy %>%
  filter(fish_asset_roster__id == "Other Fishing Equipment (note)")

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)




```

## Outside Roster Data: List of outside assets

```{r, warning=FALSE}

event_subsets <- outsideRosterTidy %>%
  select(outside_roster__id) %>%
  unique()

event_subsets

```

## *Asset: Clinic/Hospital*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- outsideRosterTidy %>%
  filter(outside_roster__id == "Clinic/Hospital")


# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)

```



## *Asset: Bank*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- outsideRosterTidy %>%
  filter(outside_roster__id == "Bank") 

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)

```




## *Asset:  Nearest Market*

```{r}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- outsideRosterTidy %>%
  filter(outside_roster__id == "Nearest Market") 

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)

```



## *Asset:  Nearest Post Office*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- outsideRosterTidy %>%
  filter(outside_roster__id == "Nearest Post Office") 

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)


```




## *Asset: Nearest Credit Facility*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- outsideRosterTidy %>%
  filter(outside_roster__id == "Nearest Credit Facility") 

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)


```


## *Asset: Nearest Police Station*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- outsideRosterTidy %>%
  filter(outside_roster__id == "Nearest Police Station") 

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)


```






## *Asset: Nearest Court House*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- outsideRosterTidy %>%
  filter(outside_roster__id == "Nearest Court House") 

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)


```


## *Asset: Airport*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- outsideRosterTidy %>%
  filter(outside_roster__id == "Airport") 

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)


```




## *Asset: Nearest Trade Store/Supermarket*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- outsideRosterTidy %>%
  filter(outside_roster__id == "Nearest Trade Store/Supermarket") 

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)


```




## *Asset: Nearest fish landing site*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- outsideRosterTidy %>%
  filter(outside_roster__id == "Nearest fish landing site") 

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)


```





## *Asset: Nearest Church*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- outsideRosterTidy %>%
  filter(outside_roster__id == "Nearest Church") 

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)


```


## Share Roster Data: List of events

```{r, warning = FALSE}

# Filter out short answer responses before moving on to plotting data subsets
shareRosterTidy <- shareRosterTidy %>%
  filter(question %in% short_answers == FALSE)

event_subsets <- shareRosterTidy %>%
  select(share_roster__id) %>%
  unique()

event_subsets
```




## *Asset: Finfish*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all MULTI-select questions: filter by event_subsets

plotDF_multiple_response <- shareRosterTidy %>%
  filter(share_roster__id == "Finfish")  %>%
  filter(is.na(option)==FALSE) %>% # Removes all "shared individually or through institution" question - all blank
  filter(response == "1")

# Plot histogram
plot_multi_response(plotDF_multiple_response, incl_island = TRUE)
```

## *Asset: Other non-finfish seafood (shellfish, sea worm, etc.)*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all MULTI-select questions: filter by event_subsets

plotDF_multiple_response <- shareRosterTidy %>%
  filter(share_roster__id == "Other non-finfish seafood (shellfish, sea worm, etc.)")  %>%
  filter(is.na(option)==FALSE) %>% # Removes all "shared individually or through institution" question - all blank
  filter(response == "1")

# Plot histogram
plot_multi_response(plotDF_multiple_response, incl_island = TRUE)

```

## *Asset: Non-fish foods*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all MULTI-select questions: filter by event_subsets

plotDF_multiple_response <- shareRosterTidy %>%
  filter(share_roster__id == "Non-fish foods")  %>%
  filter(is.na(option)==FALSE) %>% # Removes all "shared individually or through institution" question - all blank
  filter(response == "1")

# Plot histogram
plot_multi_response(plotDF_multiple_response, incl_island = TRUE)

```

## VRS Roster Data: List of events

```{r, warning=FALSE}

# Filter out short answer responses before moving on to plotting data subsets
vrsRosterTidy <- vrsRosterTidy %>%
  filter(question %in% short_answers == FALSE)


event_subsets <- vrsRosterTidy %>%
  select(vrs_roster__id) %>%
  unique()

event_subsets
```






## *VRS Roster: 1*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- vrsRosterTidy %>%
  filter(vrs_roster__id == "1") 

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)


```


## *VRS Roster: 2*
### Note: only contains one individual

```{r}

#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: VRS Roster 2 only contains one individual with the following characteristics

#vrsRosterTidy %>% filter(vrs_roster__id==2)


```

## Within Roster Data: List of events

```{r, warning = FALSE}

# Filter out short answer responses before moving on to plotting data subsets
withinRosterTidy <- withinRosterTidy %>%
  filter(question %in% short_answers == FALSE)

event_subsets <- withinRosterTidy %>%
  select(within_roster__id) %>%
  unique()

event_subsets

```





## *Asset: Nearest Church*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}
#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- withinRosterTidy %>%
  filter(within_roster__id == "Nearest Church") 

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)

```


## *Asset: Nearest Trade Store/Supermarket*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}
#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- withinRosterTidy %>%
  filter(within_roster__id == "Nearest Trade Store/Supermarket") 

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)

```



## *Asset: Airport*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}
#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- withinRosterTidy %>%
  filter(within_roster__id == "Airport") 

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)

```




## *Asset: Clinic/Hospital*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}
#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- withinRosterTidy %>%
  filter(within_roster__id == "Clinic/Hospital") 

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)

```




## *Asset: Nearest fish landing site*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}
#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- withinRosterTidy %>%
  filter(within_roster__id == "Nearest fish landing site") 

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)

```




## *Asset: Nearest Credit Facility*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}
#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- withinRosterTidy %>%
  filter(within_roster__id == "Nearest Credit Facility") 

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)

```



## *Asset: Nearest Market*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}
#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- withinRosterTidy %>%
  filter(within_roster__id == "Nearest Market") 

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)

```


## *Asset: Nearest Post Office*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}
#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- withinRosterTidy %>%
  filter(within_roster__id == "Nearest Post Office") 

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)

```



## *Asset: Nearest Court House*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}
#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- withinRosterTidy %>%
  filter(within_roster__id == "Nearest Court House") 

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)

```


## *Asset: Bank*

```{r, fig.height = 8, fig.width = 8,  results = 'asis'}
#___________________________________________________________________________________________#
# Visualize data
#___________________________________________________________________________________________#
# Note: Roster is all single-select questions: no filtering needed; subset by event_subsets

plotDF_single <- withinRosterTidy %>%
  filter(within_roster__id == "Bank") 

# Plot histogram
plot_single_response(plotDF_single, bin_n = 20, incl_island = TRUE)

```


## *Market survey*

```{r, warning=FALSE, message=FALSE, fig.height = 8, fig.width = 8,  results = 'asis'}

# Plot food item availability
plot.food.availability(marketSurvey, incl_island = TRUE)

```


### Market survey continued... 
## Food prices

```{r, warning = FALSE, message = FALSE, fig.height = 8, results = 'asis'}

# Plot prices:

plot.food.prices(market_survey_price, incl_island = TRUE)
